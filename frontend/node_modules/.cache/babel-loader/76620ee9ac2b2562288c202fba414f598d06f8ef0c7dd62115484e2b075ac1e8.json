{"ast":null,"code":"import React,{useState}from'react';import{FormControl,FormLabel,Input,Button,VStack,Select,Checkbox,useToast,HStack}from'@chakra-ui/react';import ScannerLayout from'../common/ScannerLayout';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MobileScanner=()=>{const[appFile,setAppFile]=useState(null);const[platform,setPlatform]=useState('android');const[deepScan,setDeepScan]=useState(false);const[isScanning,setIsScanning]=useState(false);const toast=useToast();const handleFileChange=e=>{if(e.target.files&&e.target.files[0]){setAppFile(e.target.files[0]);}};const handleScan=async()=>{if(!appFile){toast({title:'Error',description:'Please select an application file',status:'error',duration:3000});return;}setIsScanning(true);const formData=new FormData();formData.append('file',appFile);formData.append('platform',platform);formData.append('deepScan',String(deepScan));try{const response=await fetch('http://localhost:8000/scan/mobile',{method:'POST',body:formData});if(!response.ok)throw new Error('Scan failed');toast({title:'Success',description:'Mobile app scan started successfully',status:'success',duration:3000});}catch(error){toast({title:'Error',description:'Failed to start mobile app scan',status:'error',duration:3000});}setIsScanning(false);};return/*#__PURE__*/_jsx(ScannerLayout,{title:\"Mobile Application Scanner\",description:\"Scan mobile applications (Android APK/iOS IPA) for security vulnerabilities\",children:/*#__PURE__*/_jsxs(VStack,{spacing:6,children:[/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Upload Application\"}),/*#__PURE__*/_jsx(Input,{type:\"file\",accept:\".apk,.ipa\",onChange:handleFileChange,p:1})]}),/*#__PURE__*/_jsxs(FormControl,{children:[/*#__PURE__*/_jsx(FormLabel,{children:\"Platform\"}),/*#__PURE__*/_jsxs(Select,{value:platform,onChange:e=>setPlatform(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"android\",children:\"Android\"}),/*#__PURE__*/_jsx(\"option\",{value:\"ios\",children:\"iOS\"})]})]}),/*#__PURE__*/_jsx(HStack,{children:/*#__PURE__*/_jsx(Checkbox,{isChecked:deepScan,onChange:e=>setDeepScan(e.target.checked),children:\"Enable Deep Scan\"})}),/*#__PURE__*/_jsx(Button,{colorScheme:\"blue\",onClick:handleScan,isLoading:isScanning,loadingText:\"Scanning\",w:\"100%\",children:\"Start Mobile App Scan\"})]})});};export default MobileScanner;","map":{"version":3,"names":["React","useState","FormControl","FormLabel","Input","Button","VStack","Select","Checkbox","useToast","HStack","ScannerLayout","jsx","_jsx","jsxs","_jsxs","MobileScanner","appFile","setAppFile","platform","setPlatform","deepScan","setDeepScan","isScanning","setIsScanning","toast","handleFileChange","e","target","files","handleScan","title","description","status","duration","formData","FormData","append","String","response","fetch","method","body","ok","Error","error","children","spacing","type","accept","onChange","p","value","isChecked","checked","colorScheme","onClick","isLoading","loadingText","w"],"sources":["/home/ubuntu/VAPT/frontend/src/components/scanners/MobileScanner.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  FormControl,\n  FormLabel,\n  Input,\n  Button,\n  VStack,\n  Select,\n  Checkbox,\n  useToast,\n  HStack,\n} from '@chakra-ui/react';\nimport ScannerLayout from '../common/ScannerLayout';\n\nconst MobileScanner: React.FC = () => {\n  const [appFile, setAppFile] = useState<File | null>(null);\n  const [platform, setPlatform] = useState('android');\n  const [deepScan, setDeepScan] = useState(false);\n  const [isScanning, setIsScanning] = useState(false);\n  const toast = useToast();\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      setAppFile(e.target.files[0]);\n    }\n  };\n\n  const handleScan = async () => {\n    if (!appFile) {\n      toast({\n        title: 'Error',\n        description: 'Please select an application file',\n        status: 'error',\n        duration: 3000,\n      });\n      return;\n    }\n\n    setIsScanning(true);\n    const formData = new FormData();\n    formData.append('file', appFile);\n    formData.append('platform', platform);\n    formData.append('deepScan', String(deepScan));\n\n    try {\n      const response = await fetch('http://localhost:8000/scan/mobile', {\n        method: 'POST',\n        body: formData,\n      });\n      if (!response.ok) throw new Error('Scan failed');\n      toast({\n        title: 'Success',\n        description: 'Mobile app scan started successfully',\n        status: 'success',\n        duration: 3000,\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to start mobile app scan',\n        status: 'error',\n        duration: 3000,\n      });\n    }\n    setIsScanning(false);\n  };\n\n  return (\n    <ScannerLayout\n      title=\"Mobile Application Scanner\"\n      description=\"Scan mobile applications (Android APK/iOS IPA) for security vulnerabilities\"\n    >\n      <VStack spacing={6}>\n        <FormControl>\n          <FormLabel>Upload Application</FormLabel>\n          <Input\n            type=\"file\"\n            accept=\".apk,.ipa\"\n            onChange={handleFileChange}\n            p={1}\n          />\n        </FormControl>\n        <FormControl>\n          <FormLabel>Platform</FormLabel>\n          <Select value={platform} onChange={(e) => setPlatform(e.target.value)}>\n            <option value=\"android\">Android</option>\n            <option value=\"ios\">iOS</option>\n          </Select>\n        </FormControl>\n        <HStack>\n          <Checkbox\n            isChecked={deepScan}\n            onChange={(e) => setDeepScan(e.target.checked)}\n          >\n            Enable Deep Scan\n          </Checkbox>\n        </HStack>\n        <Button\n          colorScheme=\"blue\"\n          onClick={handleScan}\n          isLoading={isScanning}\n          loadingText=\"Scanning\"\n          w=\"100%\"\n        >\n          Start Mobile App Scan\n        </Button>\n      </VStack>\n    </ScannerLayout>\n  );\n};\n\nexport default MobileScanner;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}